!function(t){t.fn.tabComplete=function(e,i){if("string"!=typeof e){for(var n={getOptions:function(){return console.warn("Options for tab-complete not specified."),[]},select:!0,preventTabbing:!1},e=t.extend(n,e),o=t(this).data("trie")||new Triejs,s=e.getOptions(),r=0;r<s.length;r++)o.add(s[r]);t(this).data("trie",o);var a,h,f,d,c,l,u=0,p=!1;t(this).keydown(function(i){if(9===i.keyCode){if(o=t(this).data("trie"),p)u++;else{c=t(this).getCursorPosition(),a=t(this).val(),h=a.split(" ");for(var n=0,s=0;s<h.length;s++){var r=h[s];if(n+=r.length+1,n>=c){f=h[s],l=s;break}}p=!0,d=o.find(f)}if(d&&u>=d.length&&(u=0),d){i.preventDefault();var g=h;"function"==typeof e.getFormat?g[l]=e.getFormat(d[u],l):g[l]=d[u],"function"==typeof e.onComplete&&e.onComplete(f,d,d[u]);var v=h.slice(0,l+1).join(" ").length;t(this).val(h.join(" ")),e.select?t(this).selectRange(v-(g[l].length-f.length),v):t(this).selectRange(v)}e.preventTabbing&&i.preventDefault()}else p=!1,u=0}),t(this).click(function(){p=!1,u=0})}else if("add"===e){for(var o=t(this).data("trie"),r=0;r<i.length;r++)o.add(i[r]);t(this).data("trie",o)}else if("remove"===e){for(var o=t(this).data("trie"),r=0;r<i.length;r++)console.log("Removing: ",i[r]),o.remove(i[r]);t(this).data("trie",o)}else if("reset"===e){var o=new Triejs;if(i)for(var r=0;r<i.length;r++)o.add(i[r]);t(this).data("trie",o)}},t.fn.selectRange=function(t,e){return e||(e=t),this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(t,e);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",e),i.moveStart("character",t),i.select()}})},t.fn.getCursorPosition=function(){var e=t(this).get(0),i=0;if("selectionStart"in e)i=e.selectionStart;else if("selection"in document){e.focus();var n=document.selection.createRange(),o=document.selection.createRange().text.length;n.moveStart("character",-e.value.length),i=n.text.length-o}return i}}(jQuery),function(){var t=function(t){this.options={maxCache:10,enableCache:!0,insertOrder:!1,returnRoot:!1,insert:null,sort:null,clip:null,copy:null,merge:null},this.root={},this.index=0;for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e]);"function"!=typeof this.options.insert&&(this.options.insert=function(t,e){return this.options.insertOrder&&"undefined"==typeof e.d&&"undefined"==typeof e.o&&(e={d:e,o:this.index++}),t&&t.length?t.push(e):t=[e],t}),"function"!=typeof this.options.sort&&(this.options.insertOrder?this.options.insertOrder&&(this.options.sort=function(){this.sort(function(t,e){return t.o-e.o})}):this.options.sort=function(){this.sort()}),"function"!=typeof this.options.clip&&(this.options.clip=function(t){this.length>t&&this.splice(t,this.length-t)}),"function"!=typeof this.options.copy&&(this.options.copy=function(t){return t.slice(0)}),"function"!=typeof this.options.merge&&(this.options.merge=function(t,e,i){for(var n=0,o=e.length;o>n;n++)t=this.options.insert.call(this,t,e[n]),this.options.sort.call(t,i),this.options.clip.call(t,this.options.maxCache);return t})};t.prototype={_addCacheData:function(t,e){return this.root===t&&!this.options.returnRoot||this.options.enableCache===!1?!1:(t.$d||(t.$d={}),t.$d=this.options.insert.call(this,t.$d,e),this.options.sort.call(t.$d),this.options.clip.call(t.$d,this.options.maxCache),!0)},_addSuffix:function(t,e,i){var n=t.charAt(0),o=t.substring(1)||null,s={$d:{}};o&&(s.$s=o),"undefined"==typeof i[n]?i[n]=s:"undefined"==typeof i[n].$d&&(i[n].$d={},o&&"undefined"==typeof i[n].$s&&(i[n].$s=o)),i[n].$d=this.options.insert.call(this,i[n].$d,e),this.options.sort.call(i[n].$d)},_moveSuffix:function(t,e,i){var n=t.charAt(0),o=t.substring(1)||null,s={$d:{}};o&&(s.$s=o),"undefined"==typeof i[n]&&(i[n]=s),i[n].$d=this.options.copy(e)},_getDataAtNode:function(t,e){var i;return this.options.enableCache?(this.options.sort.call(t.$d,e),i=t.$d):i=this._getSubtree(t,e),this.options.insertOrder&&(i=this._stripInsertOrder(i)),i?this.options.copy(i):void 0},_stripInsertOrder:function(t){if("undefined"!=typeof t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(t[i].d);return e}},_getSubtree:function(t,e){for(var i,n,o=[t];n=o.pop();)for(var s in n)n.hasOwnProperty(s)&&("$d"==s?("undefined"==typeof i&&(i=[]),i=this.options.merge.call(this,i,n.$d,e)):"$s"!=s&&o.push(n[s]));return i},add:function(t,e){if("string"!=typeof t)return!1;1==arguments.length&&(e=t),t=t.toLowerCase();for(var i=this.root,n=0,o=t.length;o>n;n++){var s=t.charAt(n);if(i[s])n==o-1?(this._addCacheData(i,e),this._addCacheData(i[s],e)||this._addSuffix(s,e,i)):(this._addCacheData(i,e),i=i[s]);else{if(i.$s){if(i.$s==t.substring(n)){this._addCacheData(i,e)||(i.$d=this.options.insert.call(this,i.$d,e),this.options.sort.call(i.$d));break}this._moveSuffix(i.$s,i.$d,i),delete i.$s,this.options.enableCache===!1&&delete i.$d}if(!i[s]){this._addSuffix(t.substring(n),e,i),this._addCacheData(i,e);break}this._addCacheData(i,e),n==o-1&&(i[s].$s?(this._moveSuffix(i[s].$s,i[s].$d,i[s]),delete i[s].$s,this.options.enableCache===!1&&delete i[s].$d,this._addSuffix(s,e,i)):this._addCacheData(i[s],e)||this._addSuffix(s,e,i)),i=i[s]}}},remove:function(t){if("string"==typeof t&&""!==t&&!this.options.enableCache){t=t.toLowerCase();var e,i,n,o,s,r,a=this.root,h=0;for(i=0,n=t.length;n>i;i++){if(e=t.charAt(i),!a[e]){if(a.$s&&a.$s===t.substring(i))break;return}o=a,s=e,a=a[e]}r=this.options.copy(a.$d),this.options.insertOrder&&(r=this._stripInsertOrder(r)),delete a.$d,delete a.$s;for(var f in a)a.hasOwnProperty(f)&&h++;return h||delete o[s],r}},contains:function(t){if("string"!=typeof t||""==t)return!1;t=t.toLowerCase();for(var e=this.root,i=0,n=t.length;n>i;i++){var o=t.charAt(i);if(!e[o])return e.$s&&e.$s===t.substring(i)?!0:!1;e=e[o]}return e.$d&&"undefined"==typeof e.$s?!0:!1},find:function(t){if("string"!=typeof t)return void 0;if(""==t&&!this.options.returnRoot)return void 0;t=t.toLowerCase();for(var e=this.root,i=0,n=t.length;n>i;i++){var o=t.charAt(i);if(!e[o])return e.$s&&0==e.$s.indexOf(t.substring(i))?this._getDataAtNode(e,t):void 0;e=e[o]}return this._getDataAtNode(e,t)}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Triejs=t):"function"==typeof define&&define.amd?define("triejs",function(){return t}):this.Triejs=t}(this);